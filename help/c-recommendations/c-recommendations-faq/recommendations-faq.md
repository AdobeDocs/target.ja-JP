---
keywords: トラブルシューティング;よくある質問;FAQ;レコメンデーション;特殊文字;属性の重み付け;コンテンツの類似性
description: 表示Adobe TargetRecommendationsアクティビティに関するよくある質問と回答のリスト。
title: ターゲットRecommendationsに関する質問や回答はどこで見つけられますか？
feature: Recommendations
translation-type: tm+mt
source-git-commit: 2cc49dd09c0e51419feba5a844ed5c316838c696
workflow-type: tm+mt
source-wordcount: '2320'
ht-degree: 48%

---


# ![PREMIUM](/help/assets/premium.png) Recommendations FAQ

[!DNL Adobe Target] [!DNL Recommendations]アクティビティに関するよくある質問(FAQ)のリストです。

## 数値を持つカスタム属性で検索すると、カタログ検索で正しい結果が表示されないのはなぜですか。

数値を持つカスタム属性に対してカタログ検索を実行すると、そのカスタム属性は数値ではなく文字列型と見なされます。

現在、属性のタイプを変更できる機能はありません。 変更を行うには、[顧客の問題](/help/cmp-resources-and-contact-information.md#reference_ACA3391A00EF467B87930A450050077C)を開き、型を文字列から数値に変更する必要がある属性を参照します。

## カタログ内のアイテムの更新がサイトに反映されるまでに、どのくらい時間がかかりますか。

期間と結果は、項目の更新方法によって異なります。

### mboxまたはAPIで更新された項目属性

* Recommendationsは15分以内に更新されます。
* 既存のレコメンデーションと品目の属性は、更新が利用可能になるまで表示されます。
* カタログ検索は、カタログインデックス（3 ～ 8時間）の後に更新されます。

### フィードを介して更新された項目属性

* フィードの取り込み後（2 ～ 8時間）、Recommendationsが更新されます。
* 既存のレコメンデーションと品目の属性は、更新が利用可能になるまで表示されます。
* フィードの取り込み（2 ～ 8時間）後、および後続のカタログインデックス（3 ～ 8時間）後に、カタログ検索が更新されます。 カタログ検索は通常、合計5 ～ 16時間以内に更新されます。

### ターゲットUIまたはAPIを介してカタログから削除された品目

* Recommendationsは15分以内に更新されます。
* 既存のレコメンデーションと品目の属性は、更新が利用可能になるまで表示されます。
* カタログ検索は、カタログインデックス（3 ～ 8時間）の後に更新されます。

### mboxまたはAPIを介してカタログに追加された項目

* Recommendationsは、アルゴリズムの実行後に更新されます。 アルゴリズムの実行は、1 ～ 2日のアルゴリズムでは12時間ごとにスケジュールされ、7日以上のアルゴリズムでは24時間ごとにスケジュールされます。
* 既存のレコメンデーションは、追加された品目がリクエストされたキーでない場合に更新が利用可能になるまで表示されます。
* 代替レコメンデーションは、追加された品目がリクエストされたキーの場合に更新が利用可能になるまで表示されます。
* カタログ検索は、カタログインデックス（3 ～ 8時間）の後に更新されます。

### フィードを介してカタログに追加された項目

* Recommendationsは、飼料が摂取された後（2 ～ 8時間）に更新されます。 以降のアルゴリズムの実行は、1 ～ 2日のアルゴリズムでは12時間ごとにスケジュールされ、7日以上のアルゴリズムでは24時間ごとにスケジュールされます。 Recommendationsは通常、合計2 ～ 32時間以内に更新されます。
* 既存のレコメンデーションは、追加された品目がリクエストされたキーでない場合に更新が利用可能になるまで表示されます。
* 代替レコメンデーションは、追加された品目がリクエストされたキーの場合に更新が利用可能になるまで表示されます。
* フィードの取り込み（2 ～ 8時間）後、およびカタログインデックス（3 ～ 8時間）後に、カタログ検索が更新されます。 カタログ検索は通常、合計5 ～ 16時間以内に更新されます。

### その他の変更点

フィードファイルの読み込み後、またはAPIまたはmboxを介してエンティティの更新を受け取った後、60分以内に次の変更が反映されます。

* デザインテンプレートに返された項目属性。
* 返されたレコメンデーションに項目が含まれるのを防ぐグローバル除外ルールで使用される項目属性。
* 返されたレコメンデーションに項目が含まれているか除外されているかに影響する条件内のインクルージョンルールで使用される項目属性。

以下の変更は、次のアルゴリズムの実行が発生するまで反映されません（12 ～ 24 時間以内）。

* アクティビティに使用される収集ルールで使用される項目属性。
* アクティビティに関連付けられた属性またはコレクションに基づいたプロモーションで使用される項目属性。
* トップセラーまたは最も多く閲覧されたアルゴリズムの「現在のカテゴリ」または「お気に入りのカテゴリ」に項目が表示される項目カテゴリ。
* 変更された属性がアルゴリズムのカスタムキーとして使用されるカスタム属性である場合の、推奨項目のランキング。
* レコメンデーションロジックが「類似の属性を持つ品目」の場合、「コンテンツの類似性」の重み付け係数が使用される場合、または「属性の重み付け」の要素が使用される場合、1つ以上の変更された属性に基づくレコメンデーション品目のランク。

>[!NOTE]
>
>フィードファイルは、そのステータスが「項目の読み込み」から「検索インデックスの更新を準備中」に変更される際に読み込まれるとみなされます。更新がカタログ検索ユーザーインターフェイスに反映されるまでに60分以上かかる場合があります。カタログ検索は、フィードのステータスが「更新が完了しました」に変わった場合に最新の状態になります。 カタログ検索が最新でなくても、サイトには上記の時間枠の更新が反映されます。 最新のカタログ検索インデックスの更新時間は、カタログ検索ページに表示されます。

## 特殊文字によって配列が壊れてしまう場合はどうすればよいですか？{#section_D27214116EE443638A60887C7D1C534E}

JavaScript のエスケープ値を使用してください。引用符（&quot;）を使用すると、配列が壊れる恐れがあります。エスケープ値を使用したコードスニペットの例を次に示します。

```
#set($String='') 
#set($escaper=$String.class.forName('org.apache.commons.lang.StringEscapeUtils')) 
<script type="text/javascript"> 
console.log("$escaper.escapeJavaScript($entity1.name)") 
console.log("$escaper.escapeJavaScript($entity2.name)") 
console.log('$escaper.escapeJavaScript($entity3.name)') 
names.push("$escaper.escapeJavaScript($entity4.name)") 
</script>
```

## Recommendations アクティビティの作成時に、カスタム条件を含むすべての条件を選択できないのはなぜですか？ {#section_B2265AC8B8A94E0298D495A05C5D817F}

選択できる条件は現在のカテゴリに基づきます。recommendationsオファーを作成している場合、アルゴリズムピッカーには、カテゴリIDに基づく条件が表示されます。

この条件を適用する場所にカテゴリ ID が含まれていない場合、一部の条件がアルゴリズムピッカーに表示されません。

mbox内にカテゴリIDが存在する場所を使用する場合、条件選択には、該当するすべての条件が含まれます。

ターゲットには、アルゴリズムピッカーのインテリジェントフィルタリングを制御する「[互換性のない条件をフィルター](/help/c-recommendations/plan-implement.md#concept_C1E1E2351413468692D6C21145EF0B84)」設定があります。

>[!NOTE]
>
>この設定は、Visual Experience Composer（VEC）で作成されたアクティビティのみに適用されます。フォームベースの Experience Composer で作成されたアクティビティには適用されません（Target には場所のコンテキストがありません）。

[!UICONTROL 非互換の条件をフィルター]設定にアクセスするには、[!UICONTROL Recommendations]／[!UICONTROL 設定]をクリックします。

![](assets/recs_settings_filter.png)

[!UICONTROL 非互換の条件をフィルター]設定が有効になっていない場合、Target では、アルゴリズムピッカーに表示されるアルゴリズムのフィルタリングはおこなわれず、すべてのアルゴリズムが表示されます。

[!UICONTROL 非互換の条件をフィルター]設定が有効になっている場合、VEC アクティビティでは、Target によって entityId とカテゴリ ID が選択した場所から読み取られ、`currentItem|currentCategory` に基づいてアルゴリズムが表示されます（それぞれの値が該当の場所に存在している場合）。そのためデフォルトでは、選択した場所で互換性のあるアルゴリズムのみがアルゴリズムピッカーに表示されます。

[!UICONTROL 非互換の条件をフィルター]設定が有効になっている場合でも、条件の選択時に「[!UICONTROL 互換性あり]」チェックボックスをオフにすると、互換性のないアルゴリズムを表示できます。

![](assets/compatible_checkbox.png)

Target で「[!UICONTROL 互換性あり]」チェックボックスが表示されない特殊なケースは次のとおりです。

* entityId とカテゴリ ID の両方が場所に存在しており、フィルタリング対象がない。
* [!DNL mbox.js] のバージョン 55 以前を使用している。
* ページで mbox 呼び出しが実行されていない（!config.isAutoCreateGlobalMbox &amp;&amp; !config.isRegionalMbox）。
* Target のパラメーターが定義されていない。

## Recommendations のコレクションがゼロ（0）になった場合はどうすればよいですか？  {#section_E2DB2FE67CF24EEC81412BFF3FA6385D}

以前はゼロではなかったコレクションがゼロになった場合の対処法は次のとおりです。

* コレクションを再度保存して、コレクションが数値を更新したかどうかを確認できます。 再保存すると、コレクションは、そのコレクションを使用するすべてのアルゴリズムを再実行します。
* 適切な環境にいるか確認します。確認のため、[!DNL /target/products.html#recsSettings] に移動してください（以下を参照）。

   ![](assets/product_catalog.png)

* インデックスが最新か確認します。[!DNL /target/products.html#productSearch]に移動し、インデックスが何時間古いかを調べます（例：&quot;Indexed 3 hours ago&quot;）。 必要に応じてインデックスを更新できます。
* エンティティがコレクションのルールに一致しなくなる変更をフィードまたはデータレイヤーに加えていないか確認します。大文字と小文字が一致しているかチェックしてください（大文字と小文字は区別されます）。
* フィードが適切に実行されているか確認します。FTPディレクトリ、パスワードなどを変更したユーザーがいるか。
* Target は、（顧客のページやアプリに）配信の更新をできる限り早く反映します。ただし、ターゲットは、マーケターのUIを何らかの形で表す必要もあります。 ターゲットは、配信の更新を遅らせずに、UIの更新が同期されるのを待ちます。 [mboxTrace](/help/c-activities/c-troubleshooting-activities/content-trouble.md) を使用すると、リクエスト受信時のシステムの状況を確認できます。

## 一般的な属性の重み付けと、コンテンツの類似性用の属性の重み付けには、どのような違いがありますか？{#section_FCD96598CBB44B16A4C6C084649928FF}

属性の重み付けには、「標準の属性の重み付け」と「コンテンツの類似性用の属性の重み付け」の 2 種類があります。

「標準の属性の重み付け」は、コンテンツの類似性を含むほぼすべての条件タイプに適用されます。このタイプの重み付けでは、特定の属性値により多くの重みが適用されます。次の例では、Nike製品の出力レコメンデーションにバンプが表示されます。

![](assets/attribute_weighting_example.png)

「コンテンツの類似性用の属性の重み付け」は、コンテンツの類似性の条件のみに適用されます。

このタイプの重み付けはより動的で、現在の「レコメンデーションキー」（現在表示されている品目）に基づきます。次の例（ブランド x 16）では、Nike のスニーカーを閲覧していた訪問者には、Nike の競合他社のスニーカーよりも、Nike の他の製品がレコメンデーションされる可能性が高くなります。訪問者がAdidasスニーカーを閲覧している場合、その訪問者はAdidas製品を推奨する可能性が高くなります。

![](assets/content_similarity_example.png)

## Target でレコメンデーションを表示できないことがあるのはなぜですか？{#section_DB3F40673AED42228E407C05437D99E9}

Target では、利用できるレコメンデーションが少ないことが原因で、レコメンデーションを表示できないことがあります。

条件ごとに生成される値の数は、デザインで指定されたエンティティの数の3倍です。 ランタイムフィルタリング（在庫、mbox 属性のマッチングなど）が、3 倍の値が生成された後に適用されるので、値の数が提供時に 3 倍未満になることもあります。この状況を軽減するには、他のエンティティを非表示にして、デザイン内のエンティティ数を増やします。

次の JavaScript は、デザインの始めで利用可能で、リクエストされるエンティティの数を増やすことができます。この例では、リクエストされたエンティティの数は 30（3 x 10）になります。

```
#foreach($entity in $entities) 
 #if( $foreach.count > 10 ) 
  #break 
 #end 
 #set ($foo = $entity.id) 
#end 
```

## 商品を挿入／更新する API の呼び出しのサイズ制限は何ですか？フィードではなく API を 1 回呼び出すことで、5 万件の商品の更新をおこなうことは可能ですか？  {#section_434FE1F187B7436AA39B7C14C7895168}

ターゲットは、アプリケーションレベルで50 MBの投稿制限を設けます。ただし、これは`application/x-www-form-urlencoded`コンテンツタイプヘッダを渡す場合に限られます。

1 回の呼び出しで 5 万件の商品の送信を試みることは可能です。失敗した場合は、バッチに分割できます。 Adobeでは、システムの負荷によるタイムアウトの発生を減らすために、呼び出しを5,000個または10,000個の製品バッチに分割することを推奨します。

## Recommendationsの条件、プロモーション、またはテンプレートのテストルールを作成する際に、mbox名を指定する必要がありますか。{#section_FFA42ABCC5954B48A46526E32A3A88A2}

mbox パラメーターに基づいて Recommendations の条件、プロモーション、またはテンプレートテストルールを作成する際に、`mboxParameter` で `mboxName` の入力が求められなくなりました。mbox 名はオプションになりました。この変更により、複数の mbox のパラメーターを使用することや、まだエッジで記録されていないパラメーターを参照することができます。

目的のパラメーターを選択するには：

* 条件、プロモーション、またはテンプレートのテストルールを作成する際に、リストからパラメータ名を選択します。 目的のパラメーター名の最初の文字を入力する開始、または目的のパラメーター名のフルネームを入力します。
* mbox 名は覚えているが、パラメーター名は覚えていないという場合は、チェックボックスを使用して、目的のパラメーターを渡す既知の mbox に関してフィルタリングをおこないます。

いずれの方法でも、mbox とパラメーターの間にリンクはありません。条件、プロモーション、またはテンプレートのテストルールは、そのパラメーターを渡すすべてのmboxのパラメーターに基づいて動作します。

既存の条件、プロモーション、またはテンプレートテストルールを編集する場合は、作成時に指定された mbox 名と共にフィルタリング条件が表示されます。

## 新しいオーディエンスを定義した後に従来の Recommendations アクティビティを保存できないのはなぜですか？  {#section_1E47C40B1FE7479BAC3EE0F50CE7C2C4}

オーディエンスに一意の名前が付けられていることを確認してください。オーディエンスに既存のオーディエンスと同じ名前を付けた場合、従来の Recommendations アクティビティ（2016 年 10 月より前に作成された Recommendations アクティビティ）を保存することはできません。

## フィードのアップロードに使用する CSV ファイルのサイズ上限を教えてください。  {#section_20F1AF4839A447B9889B246D6E873538}

フィードのアップロードに使用する CSV ファイルの行数とサイズに上限はありません。ただし、ベストプラクティスとして、Adobeでは、ファイルのアップロード処理中にエラーが発生しないように、CSVファイルのサイズを1 GBに制限することをお勧めします。 ファイルのサイズが1 GBを超える場合は、理想的には、複数のフィードファイルに分割できます。 カスタム属性列の最大数は 100 で、カスタム属性は 4,096 文字までに制限されています。必要な列の長さに関するその他の制限は、[ターゲットの制限ページ](/help/r-troubleshooting-target/target-limits.md#reference_BEFE60C3AAA442FF94D4EBFB9D3CC9B1)で確認できます。

## エンティティを動的に除外できますか。{#exclude}

クエリ文字列で、レコメンデーションから除外したいエンティティのエンティティ ID を渡すことができます。例えば、既に買い物かごに入っている品目を除外できます。

除外機能を有効にするには、`excludedIds` mbox パラメーターを使用します。このパラメーターは、コンマ区切りのエンティティ ID のリストを指定します。例： `mboxCreate(..., "excludedIds=1,2,3,4,5")`値は、レコメンデーションのリクエスト時に送信されます。

除外は、現在のターゲット呼び出しに対してのみ実行されます。`excludedIds`値が再び渡されない限り、以降のターゲット呼び出しで項目が除外されることはありません。 すべてのページのレコメンデーションから買い物かご内の品目を除外するには、引き続き各ページの`excludedIds`値を渡します。

>[!NOTE]
>
>除外されるエンティティが多すぎる場合、レコメンデーションテンプレートを満たすのに十分なエンティティがないかのような動作になります。

`entityIds`を除外するには、オファーコンテンツURLに`&excludes=${mbox.excludedIds}`トークンを追加します。 コンテンツ URL が除外されると、必要なパラメーターが、現在の mbox リクエストパラメーターを使用して代用されます。

デフォルトでは、この機能は新しく作成されたレコメンデーションで有効になります。既存のレコメンデーションで、エンティティの動的な除外をサポートするには、保存する必要があります。

## Recommendationsのコンテンツトレースで返されるNO_CONTENT応答は何を意味しますか。

リクエストされたアルゴリズムとキーの組み合わせでレコメンデーションが使用できない場合、NO_CONTENTが返されます。 一般的に、この状況は、アルゴリズムでバックアップが無効になっていて、次の1つ以上が当てはまる場合に発生します。

* 結果はまだ準備ができていません。

   この状況は、通常、新しく作成したアクティビティを最初に保存する場合、またはアクティビティで使用するコレクション、条件、プロモーションに設定が変更された後に発生します。

* 要求されたアルゴリズム/キーの組み合わせの結果は準備完了ですが、最も近いエッジサーバーではまだキャッシュされていません。

   リクエストがキャッシュ処理を開始するので、この問題は、数ページのリロードや数分後に解決する必要があります。

* 結果の準備はできましたが、指定されたキー値に対しては使用できません。

   この状況は、通常、最新のアルゴリズムの実行後にカタログに追加された品目のレコメンデーションをリクエストし、次のアルゴリズムの実行後に解決される場合に発生します。

* テンプレートの部分レンダリングが無効になっているため、テンプレートを埋めるのに十分な結果が得られません。

   この状況は、通常、可能な結果から多くの項目を積極的にフィルターする動的な包含ルールがある場合に発生します。 状況を回避するには、バックアップを有効にし、バックアップにインクルージョンルールを適用しないでください。または、フィルターが積極的でない条件で順次条件を使用してください。

