---
description: ネイティブモバイルアプリケーション向け Visual Experience Composer（VEC）を使用すると、継続的な開発の依存関係やアプリケーションのリリースサイクルに関係なく、ユーザーが自らネイティブモバイルアプリケーションでアクティビティを作成したりコンテンツをパーソナライズすることができます。
seo-description: ネイティブモバイルアプリケーション向け Visual Experience Composer（VEC）を使用すると、継続的な開発の依存関係やアプリケーションのリリースサイクルに関係なく、ユーザーが自らネイティブモバイルアプリケーションでアクティビティを作成したりコンテンツをパーソナライズすることができます。
seo-title: モバイルアプリケーション Visual Experience Composer
solution: 'Target '
title: モバイルアプリケーション Visual Experience Composer
topic: Standard
uuid: 83702f9c-40ff-441b-b773-46b01155a6f2
translation-type: tm+mt
source-git-commit: 9b8f39240cbbd7a494d74dc0016ed666a58fd870

---


# モバイルアプリケーション Visual Experience Composer{#mobile-app-visual-experience-composer}

ネイティブモバイルアプリケーション向け Visual Experience Composer（VEC）を使用すると、継続的な開発の依存関係やアプリケーションのリリースサイクルに関係なく、ユーザーが自らネイティブモバイルアプリケーションでアクティビティを作成したりコンテンツをパーソナライズすることができます。

既存の [Visual Experience Composer](../../c-experiences/experiences.md#section_34265986611B4AB8A0E4D6ACC25EF91D) を使用すると、デベロッパーの介入なしにユーザーが自らアクティビティを作成し、エクスペリエンスをパーソナライズして、Target のグローバル mbox を介して Web のプロパティへ動的に配信できるようになります。VEC を活用すれば、ネイティブモバイルアプリケーション向けにも同様のことができるようになりました。[AEP SDK v5](https://aep-sdks.gitbook.io/docs/using-mobile-extensions/adobe-target-vec)で利用可能なMobile App VECを使用して、モバイルアプリ用 [のA/Bテスト](/help/c-activities/t-test-ab/test-ab.md) および [エクスペリエンスターゲット設定（XT）](/help/c-activities/t-experience-target/experience-target.md) アクティビティを作成できます。他のアクティビティタイプは、今後、サポートする予定です。

Mobile App VECは [、サポートされ](../../c-implementing-target/c-considerations-before-you-implement-target/supported-browsers.md#reference_01B4BF99E7D545A7998773202A2F6100)ているブラウザーに一覧表示されているブラウザーをサポートしています。

## ネイティブモバイルアプリケーション用 Visual Experience Composer の使用 {#using-the-mobile-vec}

次の図は、Mobile App VECを使用するプロセスを示しています。

![](assets/mobile-vec-diagram.png)

| 処理 | 詳細 |
|--- |--- |
| 組み合わせ | Target と共に動作するようモバイルアプリケーションとデバイスをセキュアに認証します。この手順は、デバイスの場合に1回だけ必要です。 |
| オーサリング | オーサリング[Target UI で実行されるアクションのリアルタイムのプレビューが可能な Target アクティビティ](/help/c-activities/activities.md)のオーサリング。 |
| 配信 | Target がネイティブモバイルアプリケーションへアクティビティを自動配信します。 |

**ペアリング：**

Mobile App VECは、Targetアクティビティをオーサリングするために、マーケティング担当者のモバイルアプリにリアルタイムで接続します。これを有効化するための最初の手順は、モバイルデバイスおよびアプリケーションを Target とセキュアにペアリング（認証）することです。

1. A/Bテストアクティビティを作成するときに **[!UICONTROL 、例えば「モバイルアプリケーション]**」を選択し、「ビジュアル（デフォルト） **[!UICONTROL 」を選択]** して、「 **[!UICONTROL 次へ]**」をクリックします。

   ![](assets/mobile-vec-create-1.png)

1. アプリのURLを入力し、「ディープリンク **[!UICONTROL を作成」をクリック]** します。

   ![](assets/mobile-vec-create-2.png)

ペアリングは次の手順となります。

1. ディープリンクを生成するのに利用できるアプリケーションの URL スキームを入力します。典型的なディープリンクは次のようなものです。

   `mymobileapp://path?params`

1. ディープリンクは QR コードまたは URL として利用できます。ユーザーは、QRコードをスマートフォンからスキャンしたり、URLを自分自身に送信したりできます。ディープリンク URL は認証トークンを持っており、モバイルアプリケーションとデバイスを Target とセキュアにペアリングするために利用されます。
1. モバイルデバイスでディープリンク URL を開きます。これにより、モバイルアプリケーションが起動します。SDK は VEC でペアリングとオーサリングのためにアプリケーションが起動したことを認識します。

   SDK は Target サーバーへリクエストを送って自身を登録します。Target はトークンを認証し、デバイスとのリアルタイム接続を確立します（現在は web ソケットを利用しています）。

   接続が確立されたら、アプリケーションのリアルタイムのビューが Target インターフェイスに表示されます。下のイラストにあるように、アプリケーションには赤い境界のオーバーレイが表示され、アプリケーションが Target に接続されていることを示します。

   ![](assets/mobile-vec-create-3.png)

   既にペアリングしたデバイスでは、アプリケーションを起動してオーサリングインターフェイスを開くことで再度接続することができます。

**オーサリング：**

アプリケーションが接続され、VEC 内でリアルタイムのアプリケーションのビューが表示されたら、アクティビティのオーサリングを開始できます。現時点では次の処理がサポートされています。

| アクション | 詳細 |
|--- |--- |
| スワップ画像 | 別の画像オファーを選択するか、画像のCDN URLを直接設定して画像を入れ替えます。Targetの画像オファーは、Adobe Scene7を使用 [して提供](/help/administrating-target/scene7-settings.md)されます。 |
| テキストを変更 | テキスト要素、ボタンまたはラベルのテキストコンテンツ、カラーまたはフォントサイズを変更します。 |
| 背景を変更 | テキスト領域またはボタンのコンテンツまたは要素の背景を変更します。 |

VEC で実施した処理は、リアルタイムでアプリケーション内でも見ることができ、オーサリングの最中にリアルタイムのプレビュー機能を利用することができます。処理は関連のあるモバイル画面やビューと適切に関連付けられます。

![](assets/mobile-vec-create-4.png)

## トラブルシューティング {#troubleshooting}

**モバイルアプリVECは、アプリが切断されたことを示します。**

インターネット接続が切断された可能性があります。インターネットが利用可能になってからアプリケーションを再起動すれば、新たな接続が確立されます。WiFi接続でモバイルアプリVECアクティビティをオーサリングすることをお勧めします。

**モバイルアプリVECがモバイルアプリと同期していません。**

VEC の「[!UICONTROL 更新]」ボタンをクリックして、画面を同期させます。

## Target ビューとモバイルアプリケーション {#target-views}

Mobile App VECは、ビューの新しい概念を利用しています。モバイルアプリエクスペリエンスを構成する視覚要素の論理グループです。

**Target ビューの紹介**

花を売買するアプリケーションを例にしてみましょう。このアプリケーションを使用すると、ユーザーは次のタスクをおこなうことができます。

* 購入できる花や花束を一覧表示
* 詳細を表示
* 花を購入
* 支払いオプションや住所などの設定をコントロール

このアプリケーションでは、モバイルアプリケーションの異なる画面で各タスクをおこなうことができます。ユーザーがアプリケーションを使用すると、次のタスクの 1 つを実施するための画面が表示されます。Android の開発者であれば、おそらく 4 つの異なる Android アクティビティクラスを作成し、各クラスをそれぞれのタスクに関連づけることでしょう。

この場合、これらの各タスクが、モバイルアプリケーションが移行するビューに当たると考えられます。これらをターゲットビューとして参照します。それぞれを個別に特徴付けます。Target ビュー（以下、省略して「ビュー」）は、モバイル画面に表示されるビジュアル要素の論理的コンテナです。ビューの例としては、Android の画面やアクティビティクラスがあります。

モバイルアプリケーションは普通、これほど単純には作られていません。もう少し現実的な例を見てみましょう。購入できる花や花束を一覧表示にする最初のタスクに、複数のレイアウトを作成し、異なる画面を作る機能を追加します。例えば、次の 3 つのオプションを持つ「並べ替え」機能を追加してみましょう。

* 人気度別
* 価格の安い順
* 価格の高い順

この例では、ユーザーが「並び替え」オプションを選択するたびに、アクティビティクラスが同じであっても新たな画面が表示されます。このため、これらの各画面は異なる Target ビューとして考えることができます。

マーケティング担当者としては、ローカルな mbox を設定するようデベロッパーに依頼したり、アプリケーションのリリースサイクルを経ることなく、これらの各ビューにおいて異なるエクスペリエンスを創出し、独特のオファーを実行することに関心があります。

## Target Mobile App VECの設定 {#setting-up}

モバイルアプリのMobile App VECを有効にするには、開発者は次の操作を行う必要があります。

* 起動時のAdobe Target VEC拡張の設定
   * VEC拡張機能は、 [Adobe Target拡張機能](/help/c-implementing-target/c-implementing-target-for-client-side-web/how-to-deployatjs/cmp-implementing-target-using-adobe-launch.md)に依存します。Adobe Target拡張機能が既に設定され、有効になっていることを確認します。
* Target VEC拡張機能をアプリケーションに追加します。
   * [Android - モバイルアプリケーションのセットアップ](/help/c-target-mobile-app/c-mobile-visual-experience-composer/mobile-visual-experience-composer-android.md)
   * [iOS - モバイルアプリケーションのセットアップ](/help/c-target-mobile-app/c-mobile-visual-experience-composer/mobile-visual-experience-composer-ios.md)

## Target VECの実装方法

Target VEC拡張機能は、ネットワークリクエストを介して、アプリに関連するTargetエクスペリエンスを取得します。オファーはこのネットワーク呼び出し経由で取得され、ターゲット画面に自動的に適用されます。ユーザーがアプリの複数の画面をナビゲートしながらVECエクスペリエンスを取得する際に、それ以降のネットワークリクエストは実行されません。

拡張機能のデフォルトの動作は、アプリケーションの起動時に同期ネットワークリクエスト（呼び出しブロック）を実行することです。&quot;Launch&quot;を使用すると、アプリケーションの動作に合わせてこのネットワークリクエストの動作を制御できます。

### Targetアクティビティの自動取得

これは、Target VEC拡張機能によってネットワークリクエストが自動的に開始されるデフォルトの動作です。次のいずれかのオプションを使用して、このリクエストをブロック呼び出しまたは非同期要求にすることができます。

* 同期呼び出しで取得（バックグラウンドはOFF）

   選択すると、Target VEC拡張機能はアプリケーションの起動時にブロック呼び出しとしてネットワークリクエストを行います。オファーはすぐに適用され、アプリにちらつきはありません。これは、拡張機能のデフォルトの動作です。

* 非同期呼び出しでのフェッチ（バックグラウンドはオン）

   選択すると、Target VEC拡張機能はアプリケーションの起動時にバックグラウンドでネットワークリクエストを行いますが、アプリケーションの読み込みはブロックされません。エクスペリエンスがアプリケーションのホーム画面で作成されている場合、呼び出しが完了する前に画面がレンダリングされた場合に、オファーがホーム画面に適用されないことがあります。アプリ画面のレンダリングは、通常、ライフサイクルイベント `didFinishLaunchingWithOptions` と `onActivityResumed` iOSおよびAndroidで識別されます。オファーは、それ以降のすべての画面に自動的に適用されます。

### プログラムによるTargetアクティビティの取得

Target VEC拡張機能を無効にしてネットワークリクエストを自動的に実行し、プログラムによって拡張APIを呼び出すことができます。これにより、開発者は、アプリケーションでTarget VECオファーを統合する方法を制御できます。Target VEC拡張には2つの静的メソッド `prefetchOffers` があり、これらをプログラムによってTarget `prefetchOffersBackground` VECオファーを取得するために使用できます。

* `prefetchOffers` このメソッドは、Target VECオファーが取得されるまで、現在の画面を非表示にします。オファーは、該当する場合は自動的に現在の画面に適用され、画面が再び表示されます。
* `prefetchOffersBackground` このメソッドでは、現在の画面が非表示になり、関連するTargetオファーを取得するための呼び出しが行われます。Targetオファーは *現在の画面に* 適用されず、ちらつきもありません。ユーザーが後続の画面に移動すると、オファーが自動的に適用されます。

### ターゲットワークスペースの制限の処理

起動インターフェイスを使用して、ワークスペースの `at_property` 値を設定できます。これにより、そのワークスペース内のアクティビティのみがモバイルアプリに配信されます。

## Target API呼び出しに関する一般的なガイドライン {#section_C7276795F02540DCA230AEEDF882A833}

Android 用に Target ビューを適切に追加するため、`targetView` 呼び出しを挿入する正しい位置の概要を表す簡単な表を示します。

| 許容される TargetView の位置 | 適切な追加の場合 |
|--- |--- |
| `Activity::onStart` 最後の `Activity::onResume` | `OnStart` と `OnResume` を同じまたは異なる `targetViews` とするかは開発者の任意です。同じの場合、同じ `viewName` を利用します。異なる場合は、異なるものを使用 `viewNames` します。これらのイベントは SDK が自動的に追加します。 |
| 呼び出しの `Activity::SetContent` 直後 | UI が変わらない場合、`targetView` 呼び出しを挿入できます。 |
| 内部 `View::willAppear` | 選択したビューが特定のビュー階層で一意に表示される場合。 |
| 呼び出しの `Activity::SetContentView` 直後 | アクティビティがその後コードの中のコンテンツをまったく変更または修正しない場合。 |

以下は、Android で、`targetView` の呼び出しを追加するのに不適切な位置の表です。

| 許容されない TargetView の位置 | 理由 |
|--- |--- |
| Within `Activity::onCreate` | アクティビティが作成されましたが、アクティビティに関連付けられたビューが完了していないこと、またはウィンドウにアタッチされていることが保証されていません。この位置だと、オーサリング画面がサンプルされていない、サンプルが完了していない、または非決定的な方法でオファーが適用される可能性があります。 |
| 内部 `View::didAppear` | ビューは既に表示されており、オファーの実行によりちらつきのある質の悪い UI エクスペリエンスとなります。 |
| 内部 `View::didLoad` | ビューはメインのビュー階層に関連付けられず、インスタンス化がおこなわれても、アプリケーションの UI に表示される保証はありません。 |

## 配信 {#delivery}

モバイルアプリVECを使用して作成されたTargetアクティビティは、モバイルアプリで自動的に配信されます。これらのアクティビティは、（起動設定に基づいて）アプリの起動時にプリフィードされ、ユーザーが異なるTargetビューをナビゲートしたときに適用されます。多くの場合、画面に直接マッピングされます。

`TargetVEC.prefetchOffersBackground()` APIメソッドを呼び出すと、TargetのオファーがTarget Edgeから取得され、ローカルにキャッシュされます。これにより、ネットワーク経由で取得されるのではなく、呼び出しによって `targetView()` Targetの表示がトリガーされると、Targetのオファーがキャッシュから直ちに適用されるように、ユーザーエクスペリエンスがよりスムーズになります。

追加の柔軟性を実現するために、APIを呼び出すこともできます。 `TargetVEC.prefetchOffers()` これにより、Targetオファーがプリフィードされ、Targetビューが表示されるまで適用されます（おそらく、ちらつきが発生する可能性があります）。

`TargetVEC.prefetchOffersBackground()` ユーザーが顧客のアプリケーションをナビゲートして、（現在のユーザーの Target プロファイルに関する最新のアップデートに従って）最も適切なコンテンツによってローカルの Target オファーキャッシュを更新して繰り返し呼び出すことも可能です。

Targetオファーがプリフェッチされるたびに、可能であれば、最後にトリガーされたTargetビュー `AdobeTargetMobile.targetView()` のオファーも適用されます。

## 既知の制限事項 {#limitations}

* モバイルアプリ用の [A/Bテスト](/help/c-activities/t-test-ab/test-ab.md) および [エクスペリエンスターゲット設定（XT）](/help/c-activities/t-experience-target/experience-target.md) アクティビティを作成するために、モバイルアプリVECを使用できます。他のアクティビティタイプは、今後、サポートする予定です。
* プレビュー機能はまだサポートされていません。今後のリリースで利用できるようになります。
* アプリをMobile App VECに再接続する場合は、アプリケーションを完全に終了して再起動する必要があります。

   以下のいずれかのシナリオでモバイルアプリケーションが既に開いている場合は、アプリケーションを閉じてから再度開く必要があります。ただし、アプリケーションを閉じるには、「最近使用したアプリケーション」セクションからモバイルアプリケーションを閉じる*必要があります*。「戻る」ボタンを*押さないでください*。「戻る」ボタンを押してアプリケーションを閉じると、断続的な接続の問題が発生する可能性があります。

   アプリが既に開いている場合、アプリを再起動するには、アプリケーションを再起動する必要があります。

   * 新しいアクティビティの作成中に、モバイルアプリケーションを選択すると、デバイスリストのダイアログボックスが表示されます。アプリケーションが既に開いている場合は、アプリケーションを閉じてから再起動し、選択可能として表示されているデバイスを取得する必要があります。
   * アクティビティの編集を開始すると、デバイスのダイアログボックスが表示されます。アプリケーションが既に開いている場合は、アプリケーションを閉じてから再起動し、選択可能として表示されているデバイスを取得する必要があります。
   * 「目標と設定」から「オーサリング」手順（手順 1）に戻ると、デバイスのダイアログボックスが表示されます。アプリケーションが既に開いている場合は、アプリケーションを閉じてから再起動し、Mobile App VECに接続し直す必要があります。
   アプリケーションを閉じるには、「最近使用したアプリケーション」セクションからモバイルアプリケーションを閉じる必要があります。「[!UICONTROL 戻る]」ボタンを押さないでください。

